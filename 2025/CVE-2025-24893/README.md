# ğŸ” CVE-2025-24893 â€” XWiki Critical RCE

<img width="1046" height="586" alt="cve-2025" src="https://github.com/user-attachments/assets/14742e6c-0cd8-4c8a-8b1d-290e2c3fe46f" />

**Status:** ğŸš¨ *Actively Exploited in the Wild*
**Type:** ğŸ§¨ Unauthenticated Remote Code Execution
**Product:** ğŸ§© XWiki Platform
**Risk:** ğŸ”¥ **Critical**

---

# ğŸ“ 1. Overview

* Any **guest (unauthenticated)** user can trigger unsafe Groovy evaluation inside the **SolrSearch** macro.
* This leads to **server-side code execution**, impacting the **entire platform**.
* Attackers exploit this by crafting malicious search requests that abuse template rendering.
* Used in real-world attacks to deploy malware such as **cryptominers**.

---

# ğŸ§© 2. Technical Summary

## ğŸ›£ï¸ Vulnerable Component

```
SolrSearch macro â†’ RSS rendering â†’ unsafe evaluation of user-controlled text
```


## ğŸ›¡ï¸ How to use it safely:

```
# 1. Detection only
sudo python3 CVE-2025-24893.py http://your-lab-xwiki:8080

# 2. One-liner
sudo python3 CVE-2025-24893.py http://target:8080 whoami

# 3. Interactive
sudo python3 CVE-2025-24893.py http://target:8080
```

---

## âš™ï¸ Root Cause

* âŒ Improper sanitization of user input
* âŒ Groovy code dynamically evaluated
* Leads to **CWE-94** + **CWE-95** (code generation / eval injection)

---

# ğŸ§­ 3. Affected & Fixed Versions

## âŒ Affected Versions

| ğŸ“¦ XWiki Version Line | â›” Vulnerable Range        |
| --------------------- | ------------------------- |
| 5.x â†’ 15.x            | 5.3-milestone2 â†’ 15.10.10 |
| 16.x                  | 16.0.0-RC1 â†’ 16.4.0       |

## âœ… Fixed Versions

| ğŸ¯ Safe Version | Notes             |
| --------------- | ----------------- |
| 15.10.11        | LTS fixed version |
| 16.4.1          | Stable branch fix |
| 16.5.0-RC1      | DEV branch fix    |

---

# ğŸ¯ 4. Severity â€” CVSS Breakdown

| Metric              | Value              | Emoji |
| ------------------- | ------------------ | ----- |
| **Score**           | **9.8 (Critical)** | ğŸ”¥    |
| Attack Vector       | Network            | ğŸŒ    |
| Attack Complexity   | Low                | ğŸ¯    |
| Privileges Required | None               | ğŸš«ğŸ”‘  |
| User Interaction    | None               | ğŸ™…    |
| Confidentiality     | High               | ğŸ”“    |
| Integrity           | High               | âœï¸    |
| Availability        | High               | â—     |

---

# ğŸ§¨ 5. Exploitation (High-Level Only)

âš ï¸ No harmful code â€” just conceptual description.

### ğŸ“Œ How attackers abuse it

1. Send a crafted request to the **SolrSearch** macro
2. User-controlled text is processed in an unsafe template
3. Groovy expression inside text gets executed
4. Server runs attacker-controlled instructions
5. Attacker drops malware â†’ miners, botnet clients, scripts

### ğŸ›‘ What has been seen in the wild

* ğŸŒ Global scanning for vulnerable XWiki servers
* ğŸ¤– Malware deployment (e.g., cryptominers)
* â›“ï¸ Multi-stage payload delivery
* ğŸ“¡ Command execution via template engine

---

# ğŸ›°ï¸ 6. Indicators of Compromise (IOCs)

## ğŸ” Suspicious Requests

* Strange parameters inside:

  * `media=rss`
  * Unusual template directives
  * Unexpected macro structures
* High volume of hits to:
  `/xwiki/bin/get/Main/SolrSearch`

## ğŸ§¯ System Behavior

| Symptom                              | Meaning                        |
| ------------------------------------ | ------------------------------ |
| ğŸ“ˆ CPU usage spikes                  | Mining activity                |
| ğŸ“ New binaries in `/tmp`            | Payload staging                |
| ğŸ§ª Unknown processes                 | Lateral movement / persistence |
| ğŸŒ Outbound traffic to strange hosts | Botnet or miner callouts       |

---

# ğŸ›¡ï¸ 7. Mitigation Steps

## ğŸŸ¢ 1. Upgrade Immediately

Apply one of:

* **15.10.11**
* **16.4.1**
* **16.5.0-RC1**

## ğŸŸ  2. Temporary Workarounds (Safe Descriptions)

* Restrict anonymous access
* Disable/limit SolrSearch macro if possible
* Apply vendor-provided template hardening
* Add WAF rules blocking invalid template directives

## ğŸ”µ 3. Hardening

* Run XWiki under limited OS permissions
* Limit exposure (avoid direct internet access)
* Enable audit logging
* Monitor system for IOCs above

## ğŸ”´ 4. After Patching

* Conduct forensic checks:

  * processes ğŸ‘€
  * crontabs â±ï¸
  * `/tmp/` binaries ğŸ—‚ï¸
  * outbound connections ğŸŒ

---

# ğŸ“š 8. Structured Schemas & Tables

## ğŸ“‘ Vulnerability Schema

| Field               | Value                  |
| ------------------- | ---------------------- |
| ID                  | CVE-2025-24893         |
| Type                | RCE                    |
| Vector              | Network                |
| Privileges Required | None                   |
| Affected Component  | SolrSearch macro       |
| CWE                 | 94 & 95                |
| Exploitation        | Active                 |
| Impact              | Full system compromise |

---

# ğŸ§· 9. Short Summary (Aesthetic)

âš ï¸ **CVE-2025-24893** is a critical RCE in XWikiâ€™s SolrSearch macro.
ğŸ§¨ Attackers can run code without authentication.
ğŸ”¥ Actively exploited in real-world attacks.
ğŸ›¡ï¸ Patch immediately to 15.10.11, 16.4.1, or newer.

---

### âš ï¸ Disclaimer: 

This information is for defensive and educational purposes only.
