# ğŸ” CVE-2025-64484 â€” OAuth2-Proxy Header Normalization Vulnerability

<img width="1200" height="589" alt="G5zy5OwbkAExGgS" src="https://github.com/user-attachments/assets/60775348-6781-40d6-8e2b-edb85d8fe2fb" />

### ğŸ§© **What Is It?**

A **High-severity** vulnerability in **OAuth2-Proxy** (versions **< 7.13.0**) caused by inconsistent treatment of header names that use:

* `-` dashes
* `_` underscores

Attackers can sneak malicious headers through by switching dashes â†” underscores.
This may bypass intended protections ğŸš¨

---

## âš ï¸ **Why It Matters**

* **Severity:** ğŸ”¥ **CVSS 8.5** (High)
* **Whoâ€™s affected:** Any service using OAuth2-Proxy in front of an app that *normalizes underscores and dashes* (e.g., Django, Flask, PHP apps).
* **Risk:**

  * ğŸ†” Identity spoofing
  * ğŸ”“ Privilege escalation
  * ğŸ­ Manipulating trusted â€œforwardedâ€ headers

OAuth2-Proxy itself isnâ€™t â€œbrokenâ€ â€” but it can unintentionally pass attacker-controlled headers to upstream apps.

---

## ğŸ›¡ï¸ **How to Fix It**

### âœ… **1. Upgrade**

Update to **OAuth2-Proxy 7.13.0 or later** âœ”ï¸
This fully patches the issue.

### ğŸ§° **2. Temporary Mitigations** (if you cannot upgrade)

* Ensure your upstream app **does not treat `_` and `-` as equivalent**
* Add strict header filtering or normalization rules
* Use new config option `InsecureSkipHeaderNormalization` carefully ğŸ”§

---

### How to Use CVE-2025-64484.py

#### 1. Save the file

```bash
sudo git clone https://github.com/B1ack4sh/Blackash-CVE-2025-64484.git
chmod +x CVE-2025-64484.py
```

#### 2. Run Against Your Vulnerable Lab (port 4180)

```
python3 CVE-2025-64484.py http://localhost:4180/
```

#### 3. Run Against Patched (port 4181)

```
python3 CVE-2025-64484.py http://localhost:4181/
```

**Expected Output**
Vulnerable (v7.12.0)

```
[+] Status: 200
ğŸ¯ [EXPLOIT SUCCESS] Authenticated as: admin@pwned.local
```

Patched (v7.13.0)

```
[-] Exploit failed. Header not reflected.
```

---

## ğŸ” **Technical Insight (Simplified)**

Think of it like this:

ğŸ” **OAuth2-Proxy blocks dangerous headers**
but
ğŸ­ **Attacker renames them using `_` instead of `-`**
and
ğŸ“¨ **The backend silently changes `_` â†’ `-` â€” restoring the dangerous header**

Result: A sneaky bypass. ğŸ˜ˆ

---

## âš ï¸ Disclaimer !!!

Educational use **only**. Test **solely on systems you own**. **Never** use on production, third-party, or unauthorized targets. **You** are responsible for compliance.
